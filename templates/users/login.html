

{% extends 'users/base.html' %}
{% load static %}
{% block title %}Login{% endblock title %}

{% block header %}
Login to your <span class="text-warning">SurgeSeven</span> Account
{% endblock header %}
    
{% block content %}
    <div class="p-4 p-md-5 border rounded-3 bg-dark">
        <div>
            <div>
                <form action="" method="POST" novalidate>
                    <h3>Login</h3>
                    
                    {% csrf_token %}
                    {{ form.email.label_tag }} {{ form.email }} <small class="text-danger">{{ form.email.errors|striptags }}</small><br>
                    
                    <!-- Modified password field with toggle -->
                    <div class="input-group mb-3">
                        {{ form.password.label_tag }}
                        <div class="input-group">
                            {{ form.password }}
                            <button class="btn btn-outline-secondary toggle-password" type="button">
                                <i class="bi bi-eye-slash"></i>
                            </button>
                        </div>
                        <small class="text-danger">{{ form.password.errors|striptags }}</small>
                    </div>
                    
                    <small><a href="{% url 'forgot-password' %}">Forgot Password ?</a></small>
                    <br>
                    <input type="submit" value="Login" class="btn text-white btn-warning"> <br>
                    <div class="text-center text-primary fw-bold">
                        <small class="text-white">New User? <a href="{% url 'register' %}" class="text-warning">Create an Account</a></small>
                    </div>
                
                    {% if form.non_field_errors %}
                        {% for error in form.non_field_errors %}
                            <p class="alert alert-danger my-3">{{ error }}</p>
                        {% endfor %}
                    {% endif %}
                
                    {% if messages %}
                        {% for msg in messages %}
                            <div class="alert alert-{{ msg.tags }}" role="alert">
                                {{ msg }}
                            </div>
                        {% endfor %}
                    {% endif %}
                </form>
            </div>
        </div>
    </div>
{% endblock content %}

{% block extra_js %}
<!-- Add Bootstrap Icons CSS if not already included -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css">

<script>
document.addEventListener('DOMContentLoaded', function() {
    const togglePassword = document.querySelector('.toggle-password');
    const passwordField = document.querySelector('#{{ form.password.id_for_label }}');
    
    togglePassword.addEventListener('click', function() {
        // Toggle the type attribute
        const type = passwordField.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordField.setAttribute('type', type);
        
        // Toggle the eye icon
        const icon = this.querySelector('i');
        icon.classList.toggle('bi-eye');
        icon.classList.toggle('bi-eye-slash');
    });
});
</script>
{% endblock extra_js %}